<!-- Be Naame Khoda -->
<!-- FileName: wwwroot/home.html -->

<div class="card">
    <div class="card-header">
        <h2>Welcome to Radio Scheduler</h2>
    </div>
    <div class="card-body">
        <p>This is the home page. Use the navigation menu to view logs or clear logs.</p>

        <!-- Display current date and time -->
        <div id="current-date-time">
            <h3>Current Date and Time</h3>
            <p id="date-time">Loading date and time...</p>
        </div>

        <!-- Display prayer times -->
        <div id="prayer-times">
            <h3>Prayer Times for Today</h3>
            <ul id="prayer-times-list">
                <li>Fajr: <span id="fajr-time">Loading...</span></li>
                <li>Dhuhr: <span id="dhuhr-time">Loading...</span></li>
                <li>Asr: <span id="asr-time">Loading...</span></li>
                <li>Maghrib: <span id="maghrib-time">Loading...</span></li>
                <li>Isha: <span id="isha-time">Loading...</span></li>
            </ul>
        </div>
    </div>
</div>

<script>
    // Fetch and display the current date and time
    function updateDateTime() {
        const now = new Date();
        const dateTimeElement = document.getElementById('date-time');
        if (dateTimeElement) {
            dateTimeElement.textContent = now.toLocaleString();
        }
    }

    // Fetch and display prayer times
    function fetchPrayerTimes() {
        const today = new Date();
        const year = today.getFullYear();
        const month = today.getMonth() + 1; // Months are 0-indexed
        const day = today.getDate();

        // Fetch prayer times from the server
        fetch(`/api/prayertimes?year=${year}&month=${month}&day=${day}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch prayer times');
                }
                return response.json();
            })
            .then(data => {
                // Update the prayer times in the DOM
                document.getElementById('fajr-time').textContent = data.Fajr || 'N/A';
                document.getElementById('dhuhr-time').textContent = data.Dhuhr || 'N/A';
                document.getElementById('asr-time').textContent = data.Asr || 'N/A';
                document.getElementById('maghrib-time').textContent = data.Maghrib || 'N/A';
                document.getElementById('isha-time').textContent = data.Isha || 'N/A';
            })
            .catch(error => {
                console.error('Error fetching prayer times:', error);
                document.getElementById('prayer-times-list').innerHTML = '<li>Error loading prayer times.</li>';
            });
    }

    // Update the date and time every second
    setInterval(updateDateTime, 1000);

    // Fetch prayer times when the page loads
    fetchPrayerTimes();
</script>